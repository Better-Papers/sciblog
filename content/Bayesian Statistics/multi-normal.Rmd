---
title: "Multivariate Normal Conjugacy"
section: "Bayesian Statistics"
author: "Chaichontat Sriworarat"
date: 2019-10-15
tags: ["bayesian statistics"]
include-before:
  - '$\newcommand{\summ}{\sum_{i=1}^n}$'
  - '$\newcommand{\prodd}{\prod_{i=1}^n}$'
  - '$\newcommand{\xdots}{x_1, \dots, x_n}$'
  - '$\newcommand{\expb}[1]{\exp\left\{#1\right\}}$'
  - '$\newcommand{\pp}[1]{\left(#1\right)}$'
  - '$\newcommand{\b}[1]{\mathbf{#1}}$'
  - '$\newcommand{\bs}[1]{\boldsymbol{#1}}$'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
library(blogdown)
```

# The Multivariate Normal
Recall the univariate normal
$$
\begin{align}
p(x\mid\mu,\sigma^2) &= (2\pi\sigma^2)^{-1/2} \, \expb{-\frac{(x-\mu)^2}{2\sigma^2}}\\
&= (2\pi)^{-1/2}(\sigma^2)^{-1/2}\, \expb{-\frac{1}{2}(x-\mu)(\sigma^2)^{-1}(x-\mu)}
\end{align}
$$
This is the multivariate normal.
$$
p(\b{x}\mid\bs{\mu, \Sigma}) = (2\pi)^{-k/2}\ \mathrm{det}(\bs{\Sigma})^{-1/2} \, \expb{-\frac{1}{2}(\b{x}-\bs{\mu})^\top\bs{\Sigma}^{-1}(\b{x}-\bs{\mu})}
$$

Note that $\b{x^\top Ax}$ is the multivariate analogue of $Ax^2$. The normalization constants are also updated to handle multidimensional data.

# Prior Distribution for $\bs\mu$
In the univariate case, we figured that the univariate normal is the prior.
Let $\bs{\mu}_0$ be the prior mean of length $k$ and $\bs{\Lambda}_0$ be the prior covariance matrix.
$$
\begin{align}
p(\bs{\mu} \mid \bs{\mu}_0, \bs{\Lambda}_0) &= (2\pi)^{-k/2}\ \mathrm{det}(\bs{\Lambda}_0)^{-1/2} \, \expb{-\frac{1}{2}(\bs{\mu}-\bs{\mu_0})^\top\bs{\Lambda}_0^{-1}(\bs{\mu}-\bs{\mu_0})} \\
&\propto \expb{-\frac{1}{2}\left[\bs{\mu}^\top \bs{\Lambda}_0^{-1} \bs{\mu} -2\bs{\mu}^\top\bs{\Lambda}_0^{-1}\bs{\mu_0}+\bs{\mu_0}^\top\bs{\Lambda}_0^{-1}\bs{\mu_0}\right]} \\
&\propto \expb{-\frac{1}{2} \bs{\mu}^\top \bs{\Lambda}_0^{-1} \bs{\mu} + \bs{\mu}^\top \bs{\Lambda}_0^{-1} \bs{\mu_0}} \\
\end{align}
$$

$$
\begin{align}
p(\b{x}_1,\dots,\b{x}_n \mid \bs{\mu}, \bs{\Lambda}_0) &= \prodd (2\pi)^{-k/2}\ \mathrm{det}(\bs{\Lambda}_0)^{-1/2} \, \expb{-\frac{1}{2}(\b{x}_i-\bs{\mu})^\top\bs{\Lambda}_0^{-1}(\b{x}_i-\bs{\mu})} \\
&\propto \expb{-\frac{1}{2}\summ\left[\b{x}_i^\top \bs{\Lambda}_0^{-1} \b{x}_i -2\b{x}_i^\top\bs{\Lambda}_0^{-1}\bs{\mu}+\bs{\mu}^\top\bs{\Lambda}_0^{-1}\bs{\mu}\right]} \\
&\propto \expb{-\frac{1}{2} \summ\left[\bs{\mu}^\top \bs{\Lambda}_0^{-1} \bs{\mu} + \b{x}^\top \bs{\Lambda}_0^{-1} \bs{\mu}\right]} \\
&\propto \expb{-\frac{1}{2} n\bs{\mu}^\top \bs{\Lambda}_0^{-1} \bs{\mu} + \summ \bs\mu^\top \bs{\Lambda}_0^{-1} \b{x}} \\
\end{align}
$$

# Prior Distribution for $\bs\Sigma$

